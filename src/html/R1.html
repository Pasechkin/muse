<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Muse ‚Äî –ø–æ–∏—Å–∫ —Ä–µ–ø—Ä–æ–¥—É–∫—Ü–∏–π</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { 
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
    padding:20px; 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
}
.container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}
h2 { 
    color: #333; 
    margin-bottom: 25px;
    text-align: center;
    font-weight: 300;
    letter-spacing: 1px;
}
.search-box {
    display: flex;
    gap: 10px;
    margin-bottom: 30px;
    justify-content: center;
}
input { 
    padding: 15px 20px; 
    width: 400px; 
    font-size: 16px; 
    border: 2px solid #e0e0e0; 
    border-radius: 50px; 
    transition: all 0.3s;
    outline: none;
}
input:focus { 
    border-color: #667eea; 
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
button { 
    padding: 15px 30px; 
    font-size: 16px; 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
    color:white; 
    border:none; 
    border-radius: 50px; 
    cursor:pointer;
    font-weight: 600;
    letter-spacing: 0.5px;
    transition: transform 0.2s, box-shadow 0.2s;
}
button:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
}

.results {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 25px;
    margin-top: 30px;
}

.card { 
    background: white; 
    border-radius: 15px; 
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    overflow: hidden;
    cursor: pointer;
    border: 1px solid #f0f0f0;
}
.card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    border-color: #667eea;
}

.image-container {
    height: 220px;
    overflow: hidden;
    position: relative;
    background: #f8f9fa;
}

.image-container img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transition: transform 0.5s ease;
}

.card:hover .image-container img {
    transform: scale(1.05);
}

.info { 
    padding: 20px; 
    border-top: 1px solid #f0f0f0;
}

.title { 
    font-weight: 600;
    font-size: 16px;
    color: #333;
    margin-bottom: 8px;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.artist { 
    color: #666;
    font-size: 14px;
    margin-bottom: 10px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px dashed #eee;
}

.license { 
    font-size: 12px; 
    color: #888;
    background: #f8f9fa;
    padding: 3px 8px;
    border-radius: 12px;
}

.year { 
    font-size: 12px; 
    color: #667eea;
    font-weight: 500;
}

.dimensions {
    position: absolute;
    bottom: 8px;
    right: 8px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 11px;
    backdrop-filter: blur(5px);
}

.loading {
    text-align: center;
    padding: 60px 20px;
    color: #667eea;
    font-size: 18px;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #666;
}

.empty-state h3 {
    font-weight: 300;
    margin-bottom: 20px;
    color: #333;
}

.tips {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 20px;
    margin-top: 30px;
    border-left: 4px solid #667eea;
}

.tips h4 {
    color: #333;
    margin-bottom: 10px;
    font-weight: 600;
}

.tips ul {
    list-style: none;
    padding: 0;
    margin: 0;
    color: #666;
    line-height: 1.8;
}

.tips li:before {
    content: "‚Ä¢";
    color: #667eea;
    font-weight: bold;
    display: inline-block;
    width: 1em;
    margin-left: -1em;
}
</style>
</head>
<body>

<div class="container">
    <h2>üé® Muse ‚Äî –ü–æ–∏—Å–∫ —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π</h2>
    
    <div class="search-box">
        <input id="query" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ö—É–¥–æ–∂–Ω–∏–∫–∞ –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω—ã...">
        <button onclick="search()">–ü–æ–∏—Å–∫</button>
    </div>

    <div id="results" class="results"></div>
</div>

<script>
// –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
document.getElementById('query').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        search();
    }
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ HTML –∏–∑ —Ç–µ–∫—Å—Ç–∞
function cleanText(text) {
    if (!text) return '';
    
    // –£–¥–∞–ª—è–µ–º –≤—Å–µ HTML —Ç–µ–≥–∏
    text = text.replace(/<[^>]*>/g, ' ');
    
    // –£–¥–∞–ª—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –ø—Ä–æ–±–µ–ª—ã –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è
    text = text.replace(/[^\w\s\u0400-\u04FF.,!?;:'"()\-‚Äì‚Äî]/gu, ' ');
    
    // –ó–∞–º–µ–Ω—è–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –Ω–∞ –æ–¥–∏–Ω
    text = text.replace(/\s+/g, ' ').trim();
    
    // –û–±—Ä–µ–∑–∞–µ–º —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    if (text.length > 200) {
        text = text.substring(0, 200) + '...';
    }
    
    return text;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è HTML
function escapeHtml(text) {
    if (!text) return '';
    return text
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≥–æ–¥–∞ –∏–∑ –¥–∞—Ç—ã
function extractYear(dateStr) {
    if (!dateStr) return '';
    
    // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –≥–æ–¥ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
    const yearMatch = dateStr.match(/\b\d{4}\b/);
    return yearMatch ? yearMatch[0] : '';
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —á–∏—Å—Ç–æ–≥–æ –∏–º–µ–Ω–∏ —Ö—É–¥–æ–∂–Ω–∏–∫–∞
function getCleanArtist(meta) {
    // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—è –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
    const artistFields = [
        meta.Artist?.value,
        meta.Creator?.value,
        meta.Author?.value,
        meta.Painter?.value
    ];
    
    for (const field of artistFields) {
        if (field && field.trim()) {
            const clean = cleanText(field);
            if (clean && clean !== 'Unknown') {
                return clean;
            }
        }
    }
    
    return '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ö—É–¥–æ–∂–Ω–∏–∫';
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —á–∏—Å—Ç–æ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è
function getCleanTitle(pageTitle, meta) {
    // –ü—Ä–æ–±—É–µ–º –ø–æ–ª–µ ObjectName
    if (meta.ObjectName?.value) {
        const clean = cleanText(meta.ObjectName.value);
        if (clean && clean.trim()) {
            return clean;
        }
    }
    
    // –ü—Ä–æ–±—É–µ–º –ø–æ–ª–µ ImageDescription
    if (meta.ImageDescription?.value) {
        const clean = cleanText(meta.ImageDescription.value);
        if (clean && clean.trim()) {
            return clean;
        }
    }
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
    let title = pageTitle
        .replace('File:', '')
        .replace(/\.[^/.]+$/, '') // –£–¥–∞–ª—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
        .replace(/_/g, ' ')
        .replace(/\([^)]*\)/g, '') // –£–¥–∞–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö
        .replace(/^\d+\s*[-‚Äì]\s*/, '') // –£–¥–∞–ª—è–µ–º —Ü–∏—Ñ—Ä—ã –≤ –Ω–∞—á–∞–ª–µ
        .replace(/\bby\b|\b–∏–∑\b/gi, '') // –£–¥–∞–ª—è–µ–º "by", "–∏–∑"
        .replace(/\b(a|an|the)\b/gi, '') // –£–¥–∞–ª—è–µ–º –∞—Ä—Ç–∏–∫–ª–∏
        .replace(/\s+/g, ' ')
        .trim();
    
    // –ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ, –æ–±—Ä–µ–∑–∞–µ–º
    if (title.length > 50) {
        title = title.substring(0, 50) + '...';
    }
    
    return title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
}

async function search() {
    const q = document.getElementById('query').value.trim();
    if (!q) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å');
        return;
    }

    const results = document.getElementById('results');
    results.innerHTML = `
        <div class="loading">
            <div style="font-size:48px;margin-bottom:20px;">üé®</div>
            <div>–ò—â—É –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–∞...</div>
            <div style="font-size:14px;color:#666;margin-top:10px;">
                –ò—â—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–æ—Ç 2000 –ø–∏–∫—Å–µ–ª–µ–π)
            </div>
        </div>
    `;

    // –¶–µ–ª–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    const searchQueries = [
        \`"\${q}" high resolution painting\`,
        \`\${q} high quality artwork\`,
        \`"\${q}" large painting\`,
        \`\${q} digital restoration\`,
        \`\${q} scan painting\`,
        \`"\${q}" museum quality\`
    ];

    let allPages = [];
    
    // –ò—â–µ–º —Ç–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    for (const searchQuery of searchQueries) {
        const url =
            'https://commons.wikimedia.org/w/api.php' +
            '?action=query' +
            '&generator=search' +
            '&gsrsearch=' + encodeURIComponent(searchQuery) +
            '&gsrnamespace=6' +
            '&gsrlimit=50' +
            '&prop=imageinfo' +
            '&iiprop=url|extmetadata|mime|size|dimensions' +
            '&iiurlwidth=1200' + // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –¥–ª—è –ø—Ä–µ–≤—å—é
            '&format=json' +
            '&origin=*';

        try {
            const res = await fetch(url);
            const data = await res.json();
            
            if (data.query?.pages) {
                const pages = Object.values(data.query.pages);
                console.log(\`–ù–∞–π–¥–µ–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É "\${searchQuery}": \${pages.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π\`);
                allPages = allPages.concat(pages);
            }
            
        } catch (e) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:', e);
        }
        
        await new Promise(resolve => setTimeout(resolve, 300));
    }

    // –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
    const uniquePages = [];
    const seenTitles = new Set();
    
    allPages.forEach(page => {
        if (!seenTitles.has(page.title)) {
            seenTitles.add(page.title);
            uniquePages.push(page);
        }
    });

    // –°–¢–†–û–ì–ê–Ø —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—á–µ—Å—Ç–≤—É
    const filteredPages = uniquePages.filter(page => {
        const img = page.imageinfo?.[0];
        if (!img?.url) return false;
        
        // 1. –¢–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        if (!img.mime?.startsWith('image/')) return false;
        
        // 2. –¢–æ–ª—å–∫–æ JPEG, PNG, WebP (–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã)
        const fileName = page.title.toLowerCase();
        const goodExtensions = ['.jpg', '.jpeg', '.png', '.webp'];
        if (!goodExtensions.some(ext => fileName.endsWith(ext))) return false;
        
        // 3. –ò—Å–∫–ª—é—á–∞–µ–º –≤—Å—ë –ª–∏—à–Ω–µ–µ
        const skipWords = [
            'museum', 'gallery', 'exhibition', 'expo', 'hall',
            'frame', 'framed', 'photo', 'photograph', 'photography',
            'photographer', 'scan', 'scanned', 'cropped', 'thumbnail',
            'thumb', 'icon', 'logo', 'signature', 'stamp', 'poster',
            'ticket', 'map', 'diagram', 'graph', 'chart', 'building',
            'exterior', 'interior', 'room', 'wall', 'ceiling',
            'selfie', 'portrait photo', 'photographic', 'exhibit',
            'small', 'tiny', 'mini', 'low', 'preview', 'sample',
            'detail', 'fragment', 'portion', 'section'
        ];
        
        const title = page.title.toLowerCase();
        const meta = img.extmetadata || {};
        const desc = (meta.ImageDescription?.value || '').toLowerCase();
        
        if (skipWords.some(word => title.includes(word) || desc.includes(word))) {
            return false;
        }
        
        // 4. –°–¢–†–û–ì–ò–ô –§–ò–õ–¨–¢–† –ü–û –†–ê–ó–ú–ï–†–£ –ò –†–ê–ó–†–ï–®–ï–ù–ò–Æ
        if (img.width && img.height) {
            // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ >= 2000 –ø–∏–∫—Å–µ–ª–µ–π
            if (img.width < 2000 && img.height < 2000) {
                return false;
            }
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω –¥–ª—è –∫–∞—Ä—Ç–∏–Ω
            const ratio = img.width / img.height;
            if (ratio < 0.6 || ratio > 2.5) {
                return false; // —Å–ª–∏—à–∫–æ–º –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ
            }
            
            // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –¥–ª—è –≤—ã—Å–æ–∫–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
            if (img.size && img.size < 300000) { // –º–µ–Ω—å—à–µ 300KB
                return false;
            }
        } else {
            // –ï—Å–ª–∏ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–∑–º–µ—Ä–µ, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
            return false;
        }
        
        // 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const metaKeywords = [
            'high resolution', 'high quality', 'high-resolution',
            'large', 'digital restoration', 'scan', 'scanned',
            'museum quality', 'professional', 'È´òÊ∏Ö', 'È´òÁîªË≥™'
        ];
        
        const isHighQuality = metaKeywords.some(keyword => 
            desc.includes(keyword.toLowerCase()) ||
            title.includes(keyword.toLowerCase())
        );
        
        // –ï—Å–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–æ –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ - –±–µ—Ä–µ–º –¥–∞–∂–µ —Å —á—É—Ç—å –º–µ–Ω—å—à–∏–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º
        if (!isHighQuality && (img.width < 2500 && img.height < 2500)) {
            // –î–ª—è –Ω–µ—è–≤–Ω–æ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–±—É–µ–º –µ—â–µ –±–æ–ª—å—à–µ
            return false;
        }
        
        return true;
    });

    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é (—Å–∞–º—ã–µ –±–æ–ª—å—à–∏–µ –ø–µ—Ä–≤—ã–º–∏)
    filteredPages.sort((a, b) => {
        const imgA = a.imageinfo?.[0];
        const imgB = b.imageinfo?.[0];
        const maxA = imgA ? Math.max(imgA.width, imgA.height) : 0;
        const maxB = imgB ? Math.max(imgB.width, imgB.height) : 0;
        return maxB - maxA;
    });

    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    results.innerHTML = '';
    
    if (filteredPages.length === 0) {
        results.innerHTML = \`
            <div class="empty-state">
                <div style="font-size:72px;margin-bottom:20px;">üîç</div>
                <h3>–í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:</p>
                <div class="tips">
                    <h4>–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–æ–∏—Å–∫–∞ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:</h4>
                    <ul>
                        <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è: <strong>"Ilya Repin high resolution"</strong></li>
                        <li>–î–æ–±–∞–≤—å—Ç–µ "museum quality": <strong>"Repin museum quality"</strong></li>
                        <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ "digital restoration": <strong>"Aivazovsky digital restoration"</strong></li>
                        <li>–ò—â–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω—ã: <strong>"Barge Haulers on the Volga high quality"</strong></li>
                    </ul>
                    <p style="margin-top:15px;color:#667eea;font-size:13px;">
                        <strong>–§–∏–ª—å—Ç—Ä—ã:</strong> –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –æ—Ç 2000 –ø–∏–∫—Å–µ–ª–µ–π
                    </p>
                </div>
            </div>
        \`;
        return;
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞—á–µ—Å—Ç–≤–µ
    const qualityInfo = document.createElement('div');
    qualityInfo.style.cssText = 'margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; font-size: 14px;';
    qualityInfo.innerHTML = \`
        <div style="display:flex;align-items:center;justify-content:space-between;">
            <div>
                <strong>üéØ –ù–∞–π–¥–µ–Ω–æ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π: \${filteredPages.length}</strong>
                <div style="font-size:12px;opacity:0.9;margin-top:5px;">
                    –ü–æ–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –æ—Ç 2000 –ø–∏–∫—Å–µ–ª–µ–π
                </div>
            </div>
            <div style="background:rgba(255,255,255,0.2);padding:5px 10px;border-radius:20px;font-size:12px;">
                \${filteredPages.length > 0 ? \`–ú–∞–∫—Å. —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ: \${Math.max(...filteredPages.map(p => Math.max(p.imageinfo[0].width, p.imageinfo[0].height)))}px\` : ''}
            </div>
        </div>
    \`;
    results.appendChild(qualityInfo);

    // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–∞—á–µ—Å—Ç–≤–µ
    filteredPages.forEach(page => {
        const img = page.imageinfo[0];
        const meta = img.extmetadata || {};
        
        // –ü–æ–ª—É—á–∞–µ–º —á–∏—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ
        const title = getCleanTitle(page.title, meta);
        const artist = getCleanArtist(meta);
        const year = extractYear(meta.Date?.value || meta.CreationDate?.value || '');
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é
        let qualityBadge = '';
        const maxDimension = Math.max(img.width, img.height);
        if (maxDimension >= 4000) {
            qualityBadge = '<span style="background:#4CAF50;color:white;padding:2px 8px;border-radius:12px;font-size:11px;margin-left:5px;">4K+</span>';
        } else if (maxDimension >= 3000) {
            qualityBadge = '<span style="background:#2196F3;color:white;padding:2px 8px;border-radius:12px;font-size:11px;margin-left:5px;">3K+</span>';
        } else if (maxDimension >= 2000) {
            qualityBadge = '<span style="background:#FF9800;color:white;padding:2px 8px;border-radius:12px;font-size:11px;margin-left:5px;">HD</span>';
        }
        
        // –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –ú–ë
        const fileSizeMB = img.size ? (img.size / (1024 * 1024)).toFixed(1) : '';
        
        const card = document.createElement('div');
        card.className = 'card';
        
        card.innerHTML = \`
            <div class="image-container">
                <img src="\${escapeHtml(img.url)}" 
                     loading="lazy" 
                     alt="\${escapeHtml(title)}"
                     onerror="this.onerror=null; this.style.opacity='0.5';">
                <div class="dimensions" style="display:flex;flex-direction:column;align-items:flex-end;">
                    <div>\${img.width}√ó\${img.height}</div>
                    \${fileSizeMB ? \`<div style="font-size:10px;margin-top:2px;">\${fileSizeMB} MB</div>\` : ''}
                </div>
            </div>
            <div class="info">
                <div style="display:flex;justify-content:space-between;align-items:flex-start;">
                    <div class="title" title="\${escapeHtml(title)}" style="flex:1;">\${escapeHtml(title)}</div>
                    \${qualityBadge}
                </div>
                <div class="artist" title="\${escapeHtml(artist)}">\${escapeHtml(artist)}</div>
                <div class="meta">
                    <span class="license">Public Domain</span>
                    \${year ? \`<span class="year">\${escapeHtml(year)}</span>\` : ''}
                </div>
            </div>
        \`;
        
        card.onclick = () => {
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏
            const win = window.open(\`https://commons.wikimedia.org/wiki/\${encodeURIComponent(page.title)}\`, '_blank');
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            console.log('–û—Ç–∫—Ä—ã—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:', {
                title: title,
                resolution: \`\${img.width}√ó\${img.height}\`,
                size: fileSizeMB + ' MB',
                url: img.url
            });
        };
        
        results.appendChild(card);
    });

    // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∏–ª—å—Ç—Ä–∞—Ö
    const filterInfo = document.createElement('div');
    filterInfo.className = 'tips';
    filterInfo.innerHTML = \`
        <h4>‚öôÔ∏è –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –∫–∞—á–µ—Å—Ç–≤–∞:</h4>
        <ul>
            <li><strong>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:</strong> –æ—Ç 2000 –ø–∏–∫—Å–µ–ª–µ–π –ø–æ –º–µ–Ω—å—à–µ–π —Å—Ç–æ—Ä–æ–Ω–µ</li>
            <li><strong>–§–æ—Ä–º–∞—Ç—ã:</strong> —Ç–æ–ª—å–∫–æ JPG, PNG, WebP</li>
            <li><strong>–ö–∞—á–µ—Å—Ç–≤–æ:</strong> –∏—Å–∫–ª—é—á–µ–Ω—ã –ø—Ä–µ–≤—å—é, –º–∏–Ω–∏–∞—Ç—é—Ä—ã, —Å–∫–∞–Ω—ã –Ω–∏–∑–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞</li>
            <li><strong>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:</strong> —Ç–æ–ª—å–∫–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–∞ (–∏—Å–∫–ª—é—á–µ–Ω—ã —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –º—É–∑–µ–µ–≤, —Ä–∞–º—ã –∏ —Ç.–¥.)</li>
        </ul>
        <p style="margin-top:10px;color:#666;font-size:13px;">
            <strong>–°–æ–≤–µ—Ç:</strong> –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ª—é–±—É—é –∫–∞—Ä—Ç–æ—á–∫—É, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª –Ω–∞ Wikimedia Commons.
            –î–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ –Ω–∞–∂–º–∏—Ç–µ "View original file" –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ Commons.
        </p>
    \`;
    
    results.appendChild(filterInfo);
}
</script>


</body>
</html>