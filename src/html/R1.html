<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Muse ‚Äî –ø–æ–∏—Å–∫ —Ä–µ–ø—Ä–æ–¥—É–∫—Ü–∏–π</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { 
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
    padding:20px; 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
}
.container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}
h2 { 
    color: #333; 
    margin-bottom: 25px;
    text-align: center;
    font-weight: 300;
    letter-spacing: 1px;
}
.search-box {
    display: flex;
    gap: 10px;
    margin-bottom: 30px;
    justify-content: center;
}
input { 
    padding: 15px 20px; 
    width: 400px; 
    font-size: 16px; 
    border: 2px solid #e0e0e0; 
    border-radius: 50px; 
    transition: all 0.3s;
    outline: none;
}
input:focus { 
    border-color: #667eea; 
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
button { 
    padding: 15px 30px; 
    font-size: 16px; 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
    color:white; 
    border:none; 
    border-radius: 50px; 
    cursor:pointer;
    font-weight: 600;
    letter-spacing: 0.5px;
    transition: transform 0.2s, box-shadow 0.2s;
}
button:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
}

.results {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 25px;
    margin-top: 30px;
}

.card { 
    background: white; 
    border-radius: 15px; 
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    overflow: hidden;
    cursor: pointer;
    border: 1px solid #f0f0f0;
}
.card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    border-color: #667eea;
}

.image-container {
    height: 220px;
    overflow: hidden;
    position: relative;
    background: #f8f9fa;
}

.image-container img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    transition: transform 0.5s ease;
}

.card:hover .image-container img {
    transform: scale(1.05);
}

.info { 
    padding: 20px; 
    border-top: 1px solid #f0f0f0;
}

.title { 
    font-weight: 600;
    font-size: 16px;
    color: #333;
    margin-bottom: 8px;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.artist { 
    color: #666;
    font-size: 14px;
    margin-bottom: 10px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px dashed #eee;
}

.license { 
    font-size: 12px; 
    color: #888;
    background: #f8f9fa;
    padding: 3px 8px;
    border-radius: 12px;
}

.year { 
    font-size: 12px; 
    color: #667eea;
    font-weight: 500;
}

.dimensions {
    position: absolute;
    bottom: 8px;
    right: 8px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 11px;
    backdrop-filter: blur(5px);
}

.loading {
    text-align: center;
    padding: 60px 20px;
    color: #667eea;
    font-size: 18px;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #666;
}

.empty-state h3 {
    font-weight: 300;
    margin-bottom: 20px;
    color: #333;
}

.tips {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 20px;
    margin-top: 30px;
    border-left: 4px solid #667eea;
}

.tips h4 {
    color: #333;
    margin-bottom: 10px;
    font-weight: 600;
}

.tips ul {
    list-style: none;
    padding: 0;
    margin: 0;
    color: #666;
    line-height: 1.8;
}

.tips li:before {
    content: "‚Ä¢";
    color: #667eea;
    font-weight: bold;
    display: inline-block;
    width: 1em;
    margin-left: -1em;
}
</style>
</head>
<body>

<div class="container">
    <h2>üé® Muse ‚Äî –ü–æ–∏—Å–∫ —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π</h2>
    
    <div class="search-box">
        <input id="query" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ö—É–¥–æ–∂–Ω–∏–∫–∞ –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç–∏–Ω—ã...">
        <button onclick="search()">–ü–æ–∏—Å–∫</button>
    </div>

    <div id="results" class="results"></div>
</div>

<script>
// –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
document.getElementById('query').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        search();
    }
});

async function search() {
    const q = document.getElementById('query').value.trim();
    if (!q) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å');
        return;
    }

    const results = document.getElementById('results');
    results.innerHTML = `
        <div class="loading">
            <div style="font-size:48px;margin-bottom:20px;">üé®</div>
            <div>–ò—â—É –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–∞...</div>
        </div>
    `;

    // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
    const searchQueries = [
        `${q} painting`,
        `${q} –∫–∞—Ä—Ç–∏–Ω–∞`,
        `"${q}" artwork`,
        `${q} oil on canvas`,
        `${q} —Ö—É–¥–æ–∂–Ω–∏–∫`,
        `${q} picture`
    ];

    let allPages = [];
    
    // –ü—Ä–æ–±—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
    for (const searchQuery of searchQueries) {
        const url =
            'https://commons.wikimedia.org/w/api.php' +
            '?action=query' +
            '&generator=search' +
            '&gsrsearch=' + encodeURIComponent(searchQuery) +
            '&gsrnamespace=6' +
            '&gsrlimit=30' +
            '&prop=imageinfo' +
            '&iiprop=url|extmetadata|mime|size|dimensions' +
            '&iiurlwidth=800' +
            '&format=json' +
            '&origin=*';

        try {
            const res = await fetch(url);
            const data = await res.json();
            
            if (data.query?.pages) {
                const pages = Object.values(data.query.pages);
                allPages = allPages.concat(pages);
            }
            
            // –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è
            if (allPages.length >= 50) break;
            
        } catch (e) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:', e);
        }
        
        // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
        await new Promise(resolve => setTimeout(resolve, 100));
    }

    // –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
    const uniquePages = [];
    const seenTitles = new Set();
    
    allPages.forEach(page => {
        if (!seenTitles.has(page.title)) {
            seenTitles.add(page.title);
            uniquePages.push(page);
        }
    });

    // –°—Ç—Ä–æ–≥–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
    const filteredPages = uniquePages.filter(page => {
        const img = page.imageinfo?.[0];
        if (!img?.url) return false;
        
        // 1. –¢–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        if (!img.mime?.startsWith('image/')) return false;
        
        // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
        const fileName = page.title.toLowerCase();
        const badExtensions = ['.svg', '.pdf', '.ogg', '.webm', '.tiff', '.ico', '.svgz'];
        if (badExtensions.some(ext => fileName.endsWith(ext))) return false;
        
        // 3. –ò—Å–∫–ª—é—á–∞–µ–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –º—É–∑–µ–µ–≤, –≤—ã—Å—Ç–∞–≤–æ–∫ –∏ —Ç.–¥.
        const skipWords = [
            'museum', 'gallery', 'exhibition', 'expo', 'hall',
            'frame', 'framed', 'photo', 'photograph', 'photography',
            'photographer', 'scan', 'scanned', 'cropped', 'thumbnail',
            'thumb', 'icon', 'logo', 'signature', 'stamp', 'poster',
            'ticket', 'map', 'diagram', 'graph', 'chart', 'building',
            'exterior', 'interior', 'room', 'wall', 'ceiling',
            'selfie', 'portrait photo', 'photographic'
        ];
        
        const title = page.title.toLowerCase();
        const desc = (img.extmetadata?.ImageDescription?.value || '').toLowerCase();
        
        if (skipWords.some(word => title.includes(word) || desc.includes(word))) {
            return false;
        }
        
        // 4. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏–º
        if (img.size && img.size < 80000) return false; // < 80KB
        
        // 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω (–∫–∞—Ä—Ç–∏–Ω—ã –æ–±—ã—á–Ω–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–µ)
        if (img.width && img.height) {
            const ratio = img.width / img.height;
            // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–∏—à–∫–æ–º –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ
            if (ratio < 0.5 || ratio > 3) return false;
            // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–µ
            if (img.width < 600 || img.height < 400) return false;
        }
        
        // 6. –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫–∞—Ä—Ç–∏–Ω—ã
        const meta = img.extmetadata || {};
        const categories = (meta.Categories?.value || '').toLowerCase();
        const artist = (meta.Artist?.value || '').toLowerCase();
        
        // –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω—É
        const artKeywords = [
            'painting', 'oil on canvas', 'watercolor', 'drawing',
            'artwork', 'masterpiece', 'canvas', 'painter',
            '—Ö–æ–ª—Å—Ç', '–º–∞—Å–ª–æ', '–∞–∫–≤–∞—Ä–µ–ª—å', '—Ä–∏—Å—É–Ω–æ–∫', '–∫–∞—Ä—Ç–∏–Ω–∞',
            'art', 'fine art', '–º—É–∑–µ–π', '–≥–∞–ª–µ—Ä–µ—è', '–∫–æ–ª–ª–µ–∫—Ü–∏—è'
        ];
        
        const isArtwork = artKeywords.some(keyword => 
            categories.includes(keyword) || 
            desc.includes(keyword) ||
            artist.includes(keyword) ||
            title.includes(keyword)
        );
        
        if (!isArtwork) {
            // –ï—Å–ª–∏ –Ω–µ—Ç —è–≤–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
            return false;
        }
        
        return true;
    });

    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Ä–∞–∑–º–µ—Ä—É —Ñ–∞–π–ª–∞
    filteredPages.sort((a, b) => {
        const sizeA = a.imageinfo?.[0]?.size || 0;
        const sizeB = b.imageinfo?.[0]?.size || 0;
        return sizeB - sizeA;
    });

    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    results.innerHTML = '';
    
    if (filteredPages.length === 0) {
        results.innerHTML = `
            <div class="empty-state">
                <div style="font-size:72px;margin-bottom:20px;">üé®</div>
                <h3>–ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏—Å–∫—É—Å—Å—Ç–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å:</p>
                <div class="tips">
                    <h4>–ü—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:</h4>
                    <ul>
                        <li>–ò–ª—å—è –†–µ–ø–∏–Ω (Ilya Repin)</li>
                        <li>–ò–≤–∞–Ω –ê–π–≤–∞–∑–æ–≤—Å–∫–∏–π (Ivan Aivazovsky)</li>
                        <li>–í–∞–Ω –ì–æ–≥ (Vincent van Gogh)</li>
                        <li>–î–µ–≤–æ—á–∫–∞ —Å –ø–µ—Ä—Å–∏–∫–∞–º–∏ (Girl with Peaches)</li>
                        <li>–î–µ–≤—è—Ç—ã–π –≤–∞–ª (The Ninth Wave)</li>
                        <li>–ë—É—Ä–ª–∞–∫–∏ –Ω–∞ –í–æ–ª–≥–µ (Barge Haulers on the Volga)</li>
                    </ul>
                </div>
            </div>
        `;
        return;
    }

    filteredPages.slice(0, 24).forEach(page => {
        const img = page.imageinfo[0];
        const meta = img.extmetadata || {};
        
        const title = meta.ObjectName?.value || 
                     page.title
                        .replace('File:', '')
                        .replace(/\.[^/.]+$/, '')
                        .replace(/_/g, ' ')
                        .replace(/\(.*?\)/g, '') // —É–¥–∞–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤ —Å–∫–æ–±–∫–∞—Ö
                        .trim();
        
        const artist = meta.Artist?.value || 
                      meta.Creator?.value || 
                      meta.Author?.value || 
                      '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ö—É–¥–æ–∂–Ω–∏–∫';
        
        const date = meta.Date?.value || meta.CreationDate?.value || '';
        const license = meta.LicenseShortName?.value || '';
        const medium = meta.Medium?.value || '';
        
        const year = date.match(/\d{4}/)?.[0] || '';
        
        const card = document.createElement('div');
        card.className = 'card';
        
        card.innerHTML = `
            <div class="image-container">
                <img src="${img.url}" 
                     loading="lazy" 
                     alt="${title}"
                     onerror="this.onerror=null; this.style.opacity='0.5'; this.nextElementSibling.style.display='block'">
                ${img.width && img.height ? 
                    `<div class="dimensions">${img.width}√ó${img.height}</div>` : ''}
            </div>
            <div class="info">
                <div class="title" title="${title}">${title}</div>
                <div class="artist" title="${artist}">${artist}</div>
                <div class="meta">
                    <span class="license">${license || 'CC'}</span>
                    ${year ? `<span class="year">${year}</span>` : ''}
                </div>
            </div>
        `;
        
        card.onclick = () => {
            window.open(`https://commons.wikimedia.org/wiki/${encodeURIComponent(page.title)}`, '_blank');
        };
        
        results.appendChild(card);
    });

    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–≤–µ—Ç—ã
    const tips = document.createElement('div');
    tips.className = 'tips';
    tips.innerHTML = `
        <h4>üí° –ö–∞–∫ –∏—Å–∫–∞—Ç—å –ª—É—á—à–µ:</h4>
        <ul>
            <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</li>
            <li>–£–∫–∞–∑—ã–≤–∞–π—Ç–µ –ø–æ–ª–Ω–æ–µ –∏–º—è —Ö—É–¥–æ–∂–Ω–∏–∫–∞: "Ilya Repin"</li>
            <li>–î–ª—è —Ä—É—Å—Å–∫–∏—Ö —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤ –º–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º: "–†–µ–ø–∏–Ω"</li>
            <li>–î–æ–±–∞–≤–ª—è–π—Ç–µ "painting" –∏–ª–∏ "–∫–∞—Ä—Ç–∏–Ω–∞" –∫ –Ω–∞–∑–≤–∞–Ω–∏—é</li>
        </ul>
    `;
    
    results.appendChild(tips);
}


filteredPages.slice(0, 24).forEach(page => {
    const img = page.imageinfo[0];
    const meta = img.extmetadata || {};
    
    const title = meta.ObjectName?.value || 
                 page.title
                    .replace('File:', '')
                    .replace(/\.[^/.]+$/, '')
                    .replace(/_/g, ' ')
                    .replace(/\(.*?\)/g, '')
                    .trim();
    
    const artist = meta.Artist?.value || 
                  meta.Creator?.value || 
                  meta.Author?.value || 
                  '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ö—É–¥–æ–∂–Ω–∏–∫';
    
    const date = meta.Date?.value || meta.CreationDate?.value || '';
    const license = meta.LicenseShortName?.value || '';
    const year = date.match(/\d{4}/)?.[0] || '';
    
    const card = document.createElement('div');
    card.className = 'card';
    
    // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ä—Ç–æ—á–∫–∏ –±–µ–∑ innerHTML
    const imageContainer = document.createElement('div');
    imageContainer.className = 'image-container';
    
    const imgElement = document.createElement('img');
    imgElement.src = img.url;
    imgElement.loading = 'lazy';
    imgElement.alt = title;
    imgElement.onerror = function() {
        this.style.opacity = '0.5';
    };
    
    if (img.width && img.height) {
        const dimensions = document.createElement('div');
        dimensions.className = 'dimensions';
        dimensions.textContent = `${img.width}√ó${img.height}`;
        imageContainer.appendChild(dimensions);
    }
    
    imageContainer.appendChild(imgElement);
    
    const info = document.createElement('div');
    info.className = 'info';
    
    const titleElement = document.createElement('div');
    titleElement.className = 'title';
    titleElement.title = title;
    titleElement.textContent = title;
    
    const artistElement = document.createElement('div');
    artistElement.className = 'artist';
    artistElement.title = artist;
    artistElement.textContent = artist;
    
    const metaElement = document.createElement('div');
    metaElement.className = 'meta';
    
    const licenseElement = document.createElement('span');
    licenseElement.className = 'license';
    licenseElement.textContent = license || 'CC';
    
    if (year) {
        const yearElement = document.createElement('span');
        yearElement.className = 'year';
        yearElement.textContent = year;
        metaElement.appendChild(yearElement);
    }
    
    metaElement.appendChild(licenseElement);
    
    info.appendChild(titleElement);
    info.appendChild(artistElement);
    info.appendChild(metaElement);
    
    card.appendChild(imageContainer);
    card.appendChild(info);
    
    card.onclick = () => {
        window.open(`https://commons.wikimedia.org/wiki/${encodeURIComponent(page.title)}`, '_blank');
    };
    
    results.appendChild(card);
});

</script>

</body>
</html>