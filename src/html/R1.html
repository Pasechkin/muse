<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Muse — поиск репродукций</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; background:#fafafa; padding:20px }
input { padding:10px; width:300px; font-size:16px }
button { padding:10px 14px; font-size:16px }
.results {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:20px;
  margin-top:20px;
}
.card {
  background:#fff;
  border-radius:6px;
  box-shadow:0 2px 8px rgba(0,0,0,.1);
  overflow:hidden;
}
.card img { width:100%; display:block }
.info { padding:10px; font-size:14px }
.title { font-weight:bold; margin-bottom:6px }
.artist { color:#555 }
.license { font-size:12px; color:#888 }
</style>
</head>
<body>

<h2>Поиск репродукций</h2>
<input id="query" placeholder="Van Gogh / Starry Night">
<button onclick="search()">Найти</button>

<div id="results" class="results"></div>

<script>
async function search() {
  const q = document.getElementById('query').value.trim();
  if (!q) return;

  const results = document.getElementById('results');
  results.innerHTML = 'Загрузка...';

  const url =
    'https://commons.wikimedia.org/w/api.php' +
    '?action=query' +
    '&generator=search' +
    '&gsrsearch=' + encodeURIComponent(q) +
    '&gsrlimit=20' +
    '&prop=imageinfo' +
    '&iiprop=url|extmetadata' +
    '&format=json' +
    '&origin=*';

  try {
    const res = await fetch(url);
    const data = await res.json();

    results.innerHTML = '';

    if (!data.query || !data.query.pages) {
      results.innerHTML = 'Ничего не найдено';
      return;
    }

    Object.values(data.query.pages).forEach(page => {
      const img = page.imageinfo && page.imageinfo[0];
      if (!img || !img.url) return;

      const meta = img.extmetadata || {};

      const title =
        meta.ObjectName?.value ||
        page.title.replace('File:', '');

      const artist =
        meta.Artist?.value ||
        'Автор неизвестен';

      const license =
        meta.LicenseShortName?.value || '';

      const card = document.createElement('div');
      card.className = 'card';

      card.innerHTML = `
        <img src="${img.url}">
        <div class="info">
          <div class="title">${title}</div>
          <div class="artist">${artist}</div>
          <div class="license">${license}</div>
        </div>
      `;

      results.appendChild(card);
    });

  } catch (e) {
    console.error(e);
    results.innerHTML = 'Ошибка загрузки';
  }
}
</script>

</body>
</html>

